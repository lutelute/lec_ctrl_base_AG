# 第3章：LTIシステムとたたみ込み積分 (詳細版)

本章では、制御工学の対象である「線形時不変 (LTI) システム」の性質を掘り下げ、時間領域での入出力関係を表す「たたみ込み積分」を導出します。また、ラプラス変換を用いた微分方程式の解法を詳説します。

---

## 3.1 線形時不変 (LTI) システム

制御対象の多くは、以下の2つの性質を持つ **LTI (Linear Time-Invariant) システム** として近似されます。

### 3.1.1 線形性 (Linearity)
「重ね合わせの理」が成り立つシステムです。入力 $u_1(t)$ に対する出力を $y_1(t)$、入力 $u_2(t)$ に対する出力を $y_2(t)$ とするとき、任意の定数 $\alpha, \beta$ に対して以下が成立します。
$$ \text{System}[\alpha u_1(t) + \beta u_2(t)] = \alpha y_1(t) + \beta y_2(t) $$

### 3.1.2 時不変性 (Time-Invariance)
システムの特性が変化しない性質です。入力が時間 $\tau$ だけ遅れれば、出力も同じ形を保ったまま $\tau$ だけ遅れます。
$$ \text{System}[u(t - \tau)] = y(t - \tau) $$

---

## 3.2 インパルス応答とたたみ込み積分

### 3.2.1 インパルス応答 (Impulse Response)
インパルス入力 $\delta(t)$（ディラックのデルタ関数）を加えたときのシステムの出力 $g(t)$ を **インパルス応答** と呼びます。
インパルス応答 $g(t)$ が分かれば、LTIシステムのあらゆる入力に対する出力 $y(t)$ を計算できます。

### 3.2.2 たたみ込み積分 (Convolution Integral) の導出
任意の入力信号 $u(t)$ を、微分的な幅 $d\tau$ を持つ「短冊状のパルス列」の集まりと考えます。
時刻 $\tau$ におけるパルスの高さは $u(\tau)$、幅は $d\tau$ なので、その面積（強さ）は $u(\tau)d\tau$ です。これを時刻 $\tau$ に発生したインパルス入力 $u(\tau)d\tau \cdot \delta(t-\tau)$ とみなします。

1.  時刻 $\tau$ に入力されたインパルス $u(\tau)d\tau$ に対する、時刻 $t$ での応答は？
    時不変性より、時刻 $\tau$ に入ったインパルスの応答は $t-\tau$ 秒後（すなわち現在時刻 $t$）には $g(t-\tau)$ という減衰カーブを描いています。
    強さが $u(\tau)d\tau$ 倍されているので、応答は：
    $$ dy(t) = g(t - \tau) \cdot u(\tau) d\tau $$

2.  これらをすべての過去の時刻（$\tau = 0$ から $t$ まで）について足し合わせます（線形性）。
    $$ y(t) = \int_{0}^{t} g(t - \tau) u(\tau) d\tau $$

これを **たたみ込み積分** と呼び、$g(t) * u(t)$ と書きます。

> **公式：たたみ込み積分**
> $$ y(t) = \int_{0}^{t} g(t - \tau) u(\tau) d\tau = \int_{0}^{t} g(\tau) u(t - \tau) d\tau $$

---

## 3.3 ラプラス変換による微分方程式の解法

たたみ込み積分は計算が複雑ですが、ラプラス変換を使うと「掛け算」に単純化できます。これがラプラス変換を使う最大の理由です。

### 3.3.1 たたみ込み定理 (Convolution Theorem)
時間領域でのたたみ込みは、s領域での積になります。

> $$ \mathcal{L}[g(t) * u(t)] = G(s) U(s) $$

ここで $G(s) = \mathcal{L}[g(t)]$ は **伝達関数 (Transfer Function)** です。
つまり、出力 $Y(s)$ は単純に伝達関数と入力の積で求まります。
$$ Y(s) = G(s) U(s) $$

### 3.3.2 解法の手順と例題
微分方程式をラプラス変換を用いて解く手順を、具体例で示します。

**【例題】**
以下の微分方程式を解き、出力 $y(t)$ を求めよ。
$$ \frac{d^2 y}{dt^2} + 3 \frac{dy}{dt} + 2y(t) = 1 $$
ただし初期条件は $y(0) = 0, y'(0) = 0$ とする（初期静止）。

**【解法】**

1.  **両辺をラプラス変換する**
    微分定理 $\mathcal{L}[y'] = sY(s), \mathcal{L}[y''] = s^2 Y(s)$ （初期値0より）を用います。右辺の $1$（ステップ入力）は $1/s$ です。
    $$ (s^2 Y(s)) + 3(s Y(s)) + 2 Y(s) = \frac{1}{s} $$

2.  **Y(s) について解く**
    $$ (s^2 + 3s + 2) Y(s) = \frac{1}{s} $$
    特性方程式 $s^2 + 3s + 2 = (s+1)(s+2)$ なので、
    $$ Y(s) = \frac{1}{s (s+1) (s+2)} $$

3.  **部分分数展開する**
    $$ Y(s) = \frac{A}{s} + \frac{B}{s+1} + \frac{C}{s+2} $$
    ヘヴィサイドの展開定理（留数法）で係数を求めます。
    - $A = \left.\frac{1}{(s+1)(s+2)}\right|_{s=0} = \frac{1}{2}$
    - $B = \left.\frac{1}{s(s+2)}\right|_{s=-1} = \frac{1}{-1(1)} = -1$
    - $C = \left.\frac{1}{s(s+1)}\right|_{s=-2} = \frac{1}{-2(-1)} = \frac{1}{2}$

    よって、
    $$ Y(s) = \frac{1/2}{s} - \frac{1}{s+1} + \frac{1/2}{s+2} $$

4.  **逆ラプラス変換する**
    $$ y(t) = \frac{1}{2} - e^{-t} + \frac{1}{2} e^{-2t} $$

これが微分方程式の解（時間応答）です。
$t \to \infty$ とすると $y(\infty) = 1/2$ に収束することも分かります（定常値）。

---

## 3.4 伝達関数の意味再考
上記の手順から分かるように、伝達関数 $G(s)$ は「微分方程式の微分演算子 $d/dt$ を変数 $s$ に置き換えた代数式」と捉えることができます。
$$ \ddot{y} + 3\dot{y} + 2y = u \quad \xrightarrow{\mathcal{L}} \quad (s^2 + 3s + 2)Y(s) = U(s) $$
$$ \therefore \frac{Y(s)}{U(s)} = G(s) = \frac{1}{s^2 + 3s + 2} $$
これにより、微分方程式を意識せずに、ブロック線図の代数演算（足し算・掛け算）だけでシステムを設計・解析できるようになります。
