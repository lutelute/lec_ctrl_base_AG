# 第4章：伝達関数とブロック線図 (詳細版)

本章では、システムの入出力特性を表現する「伝達関数」の概念を確立し、複雑なシステムを単純化する「ブロック線図」の代数規則（等価変換）を導出します。

---

## 4.1 伝達関数の定義

LTIシステムにおいて、初期値を全て0としたときの「出力信号のラプラス変換 $Y(s)$」と「入力信号のラプラス変換 $U(s)$」の比を、そのシステムの **伝達関数 (Transfer Function)** $G(s)$ と定義します。

> $$ G(s) = \frac{Y(s)}{U(s)} \quad \iff \quad Y(s) = G(s)U(s) $$

### 4.1.1 基本要素の伝達関数導出

物理法則から微分方程式を立て、ラプラス変換して $Y(s)/U(s)$ を求めます。

#### (1) 積分要素
- 関係式: $y(t) = \int_{0}^{t} u(\tau) d\tau$ （または $\dot{y}(t) = u(t)$）
- ラプラス変換: $sY(s) = U(s)$ （初期値0）
- 伝達関数:
  $$ G(s) = \frac{1}{s} $$

#### (2) 微分要素
- 関係式: $y(t) = \frac{du(t)}{dt}$
- ラプラス変換: $Y(s) = sU(s)$
- 伝達関数:
  $$ G(s) = s $$

#### (3) 1次遅れ要素 (First-Order Lag)
- 例: RC回路、粘性減衰系
- 微分方程式: $T \frac{dy}{dt} + y(t) = K u(t)$
- ラプラス変換: $(Ts + 1)Y(s) = K U(s)$
- 伝達関数:
  $$ G(s) = \frac{K}{Ts + 1} $$
  - $K$: ゲイン定数
  - $T$: 時定数 (Time Constant)

#### (4) 2次遅れ要素 (Second-Order Lag)
- 例: ばね・マス・ダンパ系、RLC回路
- 微分方程式: $\frac{d^2y}{dt^2} + 2\zeta\omega_n \frac{dy}{dt} + \omega_n^2 y(t) = \omega_n^2 u(t)$ （標準形）
- ラプラス変換: $(s^2 + 2\zeta\omega_n s + \omega_n^2)Y(s) = \omega_n^2 U(s)$
- 伝達関数:
  $$ G(s) = \frac{\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2} $$
  - $\omega_n$: 固有角周波数 (Natural Frequency)
  - $\zeta$: 減衰係数 (Damping Ratio)

---

## 4.2 極と零点

伝達関数 $G(s)$ は、一般に多項式の比で表されます。
$$ G(s) = K \frac{(s - z_1)(s - z_2)\dots(s - z_m)}{(s - p_1)(s - p_2)\dots(s - p_n)} $$

### 4.2.1 定義
- **極 (Poles)** $p_i$: 分母多項式 $= 0$ の根。$|G(s)| \to \infty$ となる点。システムの安定性と応答波形（指数関数の肩）を決定します。
- **零点 (Zeros)** $z_i$: 分子多項式 $= 0$ の根。$G(s) = 0$ となる点。応答の形状（特に過渡応答の振幅や逆応答）に影響します。

### 4.2.2 特性方程式 (Characteristic Equation)
伝達関数の分母多項式を0とおいた方程式 $D(s) = 0$ を **特性方程式** と呼びます。
その解（極）がシステムの挙動そのものを支配するため、「特性」方程式と呼ばれます。

---

## 4.3 ブロック線図の結合則

複雑なシステムは基本要素のブロック線図で表現されます。全体の入出力関係を求めるには、ブロック線図を等価変換して一つにまとめます。

### 4.3.1 直列結合 (Series)
ブロック $G_1(s)$ と $G_2(s)$ が直列につながっている場合。
- 信号の流れ: $U \to \boxed{G_1} \xrightarrow{X} \boxed{G_2} \to Y$
- 式: $X(s) = G_1(s)U(s)$, $Y(s) = G_2(s)X(s)$
- 代入: $Y(s) = G_2(s)(G_1(s)U(s)) = G_1(s)G_2(s) U(s)$
- 合成伝達関数:
  $$ G(s) = G_1(s) G_2(s) $$
  **（積になる）**

### 4.3.2 並列結合 (Parallel)
ブロック $G_1(s)$ と $G_2(s)$ が並列で、出力が加え合わせ点に入る場合。
- 信号の流れ: $U$ が分岐し、$Y = G_1 U + G_2 U$
- 合成伝達関数:
  $$ G(s) = G_1(s) + G_2(s) $$
  **（和になる）**

### 4.3.3 フィードバック結合 (Feedback) **【最重要】**
前向き要素 $G(s)$ とフィードバック要素 $H(s)$ からなる閉ループ。

- 入力 $R(s)$、出力 $Y(s)$、偏差（誤差） $E(s)$、フィードバック信号 $B(s)$
- 加え合わせ点: $E(s) = R(s) - B(s)$ （負帰還）
- 前向き経路: $Y(s) = G(s) E(s)$
- 帰還経路: $B(s) = H(s) Y(s)$

これらを連立して $E$ と $B$ を消去します。
$$ Y(s) = G(s) (R(s) - H(s)Y(s)) $$
$$ Y(s) = G(s)R(s) - G(s)H(s)Y(s) $$
$$ (1 + G(s)H(s)) Y(s) = G(s)R(s) $$

よって閉ループ伝達関数 $W(s)$ は：
> $$ W(s) = \frac{Y(s)}{R(s)} = \frac{G(s)}{1 + G(s)H(s)} $$

- 分母 $1 + G(s)H(s) = 0$ が閉ループ系の特性方程式になります。
- $G(s)H(s)$ を **一巡伝達関数 (Loop Transfer Function)** または開ループ伝達関数と呼びます。

---

## 4.4 メイソンの信号（シグナル）フロー線図（参考）

複雑なブロック線図を一発で解く公式として **メイソンの利得公式** があります。
$$ G(s) = \frac{1}{\Delta} \sum_{k} P_k \Delta_k $$
実用上は、内側のループから順にフィードバック結合則を適用して簡略化していく方法（縮約法）が確実です。
