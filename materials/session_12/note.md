# 第12章：制御系の定常特性 (詳細版)

本章では、時間 $t \to \infty$ において制御偏差がどのように振る舞うかを解析します。
「最終値定理」を用いて定常偏差を計算する方法を学び、「システム（ループ伝達関数）の型」と「入力信号の種類」の関係を整理します。

---

## 12.1 定常偏差の定義

フィードバック制御系において、入力 $R(s)$ と出力 $Y(s)$ の差である偏差 $E(s)$ は以下のように表されます。
$$ E(s) = R(s) - Y(s) = \frac{1}{1 + L(s)} R(s) $$
ここで $L(s) = G(s)H(s)$ は一巡伝達関数です。
定常偏差 $e_{ss}$ は、安定なシステムにおいて最終値定理を用いて計算できます。

> $$ e_{ss} = \lim_{t \to \infty} e(t) = \lim_{s \to 0} s E(s) = \lim_{s \to 0} \frac{s R(s)}{1 + L(s)} $$

---

## 12.2 システムの型と偏差定数

一巡伝達関数 $L(s)$ が原点にいくつの極（積分器 $1/s$）を持っているかで、システムを分類します。
$$ L(s) = \frac{K}{s^\ell (T_1 s + 1)(T_2 s + 1)\dots} $$
$\ell$ の値を **システムの型 (Type)** と呼びます。

### 12.2.1 ステップ入力（位置入力）に対する定常偏差
入力 $r(t) = u(t)$ (単位ステップ) のとき、$R(s) = 1/s$ です。
$$ e_{ss} = \lim_{s \to 0} \frac{s (1/s)}{1 + L(s)} = \frac{1}{1 + \lim_{s \to 0} L(s)} $$

ここで **位置偏差定数** $K_p$ を定義します。
$$ K_p = \lim_{s \to 0} L(s) $$
定常偏差は $e_{ss} = \frac{1}{1 + K_p}$ です。

- **0型 ($\ell=0$)**: $K_p = K$ (有限確定値)。偏差は $1/(1+K)$ 残ります。
- **1型 ($\ell \ge 1$)**: $K_p = \infty$。偏差は $0$ になります。
  - 物理的意味: 積分器が一つあれば、一定の目標値には完全に追従できます。

### 12.2.2 ランプ入力（速度入力）に対する定常偏差
入力 $r(t) = t u(t)$ のとき、$R(s) = 1/s^2$ です。
$$ e_{ss} = \lim_{s \to 0} \frac{s (1/s^2)}{1 + L(s)} = \lim_{s \to 0} \frac{1}{s + sL(s)} = \lim_{s \to 0} \frac{1}{sL(s)} $$

ここで **速度偏差定数** $K_v$ を定義します。
$$ K_v = \lim_{s \to 0} s L(s) $$
定常偏差は $e_{ss} = \frac{1}{K_v}$ です。

- **0型 ($\ell=0$)**: $K_v = \lim s K = 0$。偏差は $\infty$（追従不能）。
- **1型 ($\ell=1$)**: $K_v = \lim s \frac{K}{s(\dots)} = K$。偏差は $1/K$（一定の遅れで追従）。
- **2型 ($\ell \ge 2$)**: $K_v = \lim s \frac{K}{s^2(\dots)} = \infty$。偏差は $0$。

### 12.2.3 放物線入力（加速度入力）に対する定常偏差
入力 $r(t) = \frac{1}{2}t^2 u(t)$ のとき、$R(s) = 1/s^3$ です。
**加速度偏差定数** $K_a$ を定義します。
$$ K_a = \lim_{s \to 0} s^2 L(s) $$
定常偏差は $e_{ss} = \frac{1}{K_a}$ です。

- **0型, 1型**: $K_a = 0$。偏差は $\infty$。
- **2型**: $K_a = K$。偏差は $1/K$。
- **3型**: $K_a = \infty$。偏差は $0$。

---

## 12.3 内部モデル原理 (Internal Model Principle)

以上の結果を一般化した原理です。
「制御系が、外部から加わる信号（目標値や外乱）の発生モデル（特性）をフィードバックループ内に含んでいるならば、その信号に対する定常偏差はゼロになる。」

- ステップ信号の発生源: $1/s$ (積分器)。ループ内に $1/s$ があればステップ偏差ゼロ。
- ランプ信号の発生源: $1/s^2$ (二重積分)。ループ内に $1/s^2$ があればランプ偏差ゼロ。
- 正弦波信号 ($\sin \omega t$) の発生源: $1/(s^2 + \omega^2)$。ループ内にこの共振項があれば、その周波数の正弦波に対する偏差（振幅・位相ズレ）はゼロになります。

---

## 12.4 演習問題

**問題**:
一巡伝達関数 $L(s) = \frac{10(s+1)}{s(s+2)(s+5)}$ の系について、以下の問に答えよ。

1.  このシステムの型はいくつか。
2.  単位ステップ入力に対する定常偏差を求めよ。
3.  単位ランプ入力に対する定常偏差を求めよ。

**解答**:

1.  分母に $s$ が1つあるので、**1型システム** です。
2.  1型システムなので、ステップ入力に対する位置偏差定数 $K_p = \infty$。
    よって定常偏差は **0**。
    （確認: $e_{ss} = \frac{1}{1+\infty} = 0$）
3.  速度偏差定数 $K_v$ を計算します。
    $$ K_v = \lim_{s \to 0} s L(s) = \lim_{s \to 0} s \cdot \frac{10(s+1)}{s(s+2)(s+5)} = \lim_{s \to 0} \frac{10(s+1)}{(s+2)(s+5)} $$
    $$ K_v = \frac{10(1)}{(2)(5)} = \frac{10}{10} = 1 $$
    よって定常偏差は $e_{ss} = \frac{1}{K_v} = \mathbf{1}$。

**考察**:
この系はランプ入力に対して、大きさ1の偏差を残しながら追従します。
ゲインを10倍にして $L(s) = \frac{100(s+1)}{s(s+2)(s+5)}$ とすれば、$K_v=10$ となり、偏差は $0.1$ に減少します。
積分特性を高域ゲイン（過渡応答）を変えずに改善するためには、「ラグ補償（遅れ補償）」などが使われます。
