# 第13章：制御系の周波数特性・詳細 (詳細版)

本章では、実務的な制御系設計の心臓部となる「ボード線図」の手書き手法をマスターし、さらに位相補償（進み・遅れ補償）の原理について学びます。
120分の講義を想定し、漸近線近似による作図テクニックを詳しく解説します。

---

## 13.1 ボード線図の合成則

複雑な伝達関数 $G(s)$ も、基本要素の積に分解できれば、対数の性質 $\log(AB) = \log A + \log B$ により、グラフの足し算で作図できます。

伝達関数の一般形：
$$ G(j\omega) = K \frac{(j\omega T_a + 1)(j\omega T_b + 1)\dots}{(j\omega)^\ell (j\omega T_1 + 1)(j\omega T_2 + 1)\dots} $$

### 13.1.1 基本要素のボード線図（作図ルール）

1.  **ゲイン定数 $K$**
    - ゲイン: $20 \log_{10} K$ [dB] の水平線。
    - 位相: $0^\circ$ ($K>0$) または $-180^\circ$ ($K<0$)。

2.  **積分要素 $1/j\omega$**
    - ゲイン: $\omega=1$ で 0 dB。傾き **-20 dB/dec** の直線。
    - 位相: **-90°** 一定。

3.  **微分要素 $j\omega$**
    - ゲイン: $\omega=1$ で 0 dB。傾き **+20 dB/dec** の直線。
    - 位相: **+90°** 一定。

4.  **1次遅れ要素 $1/(j\omega T + 1)$**
    - 折れ点周波数: $\omega_c = 1/T$。
    - ゲイン: $\omega < \omega_c$ で 0 dB。$\omega > \omega_c$ で **-20 dB/dec** の直線。
      (厳密には $\omega_c$ で -3 dB の誤差)
    - 位相: $\omega = 0.1\omega_c$ で $0^\circ$、$\omega = \omega_c$ で $-45^\circ$、$\omega = 10\omega_c$ で $-90^\circ$ を通る曲線。

5.  **1次進み要素 $(j\omega T + 1)$**
    - 1次遅れの逆特性（ゲインは +20 dB/dec、位相は +90° 方向へ）。

6.  **2次遅れ要素 $\omega_n^2 / ((j\omega)^2 + 2\zeta\omega_n(j\omega) + \omega_n^2)$**
    - 折れ点周波数: $\omega_n$。
    - ゲイン: $\omega < \omega_n$ で 0 dB。$\omega > \omega_n$ で **-40 dB/dec** の直線。
      $\zeta < 0.7$ の場合、$\omega_n$ 付近でピーク（共振）を持つ。ピーク値は $M_p \approx 1/(2\zeta)$。
    - 位相: $\omega_n$ で $-90^\circ$。最終的に $-180^\circ$。

### 13.1.2 手書き作図の手順（例題）

$$ G(s) = \frac{10}{s(0.1s + 1)} $$

1.  **要素分解**:
    - ゲイン定数 $K=10$ (20dB)
    - 積分要素 $1/s$
    - 1次遅れ要素 $1/(0.1s+1)$ （折れ点 $\omega_c = 10$）

2.  **低周波域の漸近線を決定**:
    $\omega \ll 10$ では $1/(0.1s+1) \approx 1$ なので、実質 $10/s$。
    $\omega=1$ のとき $|10/j| = 10 \approx 20$ dB。
    $\omega=1$ を通る傾き -20 dB/dec の直線を引く。（これがベースライン）

3.  **高周波域の修正**:
    $\omega = 10$ から、さらに1次遅れの影響で傾きが -20 dB/dec 加算される。
    つまり、$\omega > 10$ では **-40 dB/dec** になる。

4.  **位相線図**:
    - 積分要素で $-90^\circ$（ベース）。
    - $\omega=10$ 付近で1次遅れの遅れ位相（最大 $-90^\circ$）が加わる。
    - $\omega=1$ で $\approx -90^\circ$
    - $\omega=10$ で $-90^\circ - 45^\circ = -135^\circ$
    - $\omega=100$ で $\approx -180^\circ$

---

## 13.2 位相補償 (Phase Compensation)

ボード線図を整形して、安定余裕や応答性を改善する手法です。

### 13.2.1 位相進み補償 (Phase Lead Compensation)
$$ C_{lead}(s) = K \frac{Ts + 1}{\alpha T s + 1} \quad (0 < \alpha < 1) $$
- **効果**: 高周波域のゲインを上げつつ、位相を進める（最大で $\sin^{-1}\frac{1-\alpha}{1+\alpha}$ 度）。
- **目的**: 交差周波数付近の位相余裕を増やし、**速応性** と **安定性** を改善する。
- **欠点**: 高周波ノイズを増幅しやすい。

### 13.2.2 位相遅れ補償 (Phase Lag Compensation)
$$ C_{lag}(s) = K \frac{Ts + 1}{\beta T s + 1} \quad (\beta > 1) $$
- **効果**: 低周波域のゲイン（$K$）を保ったまま、高周波域のゲインを下げる。位相は遅れるが、交差周波数を下げることで結果的に位相余裕を確保する。
- **目的**: 定常偏差を改善（低周波ゲイン大）しつつ、**安定性** を確保する。
- **欠点**: 応答が遅くなる（帯域が狭くなる）。

---

## 13.3 演習問題

**問題**:
一巡伝達関数 $L(s) = \frac{K}{s(s+1)(s+2)}$ のゲイン交差周波数を $\omega_{gc}=1$ [rad/s] にしたい。
(1) 必要なゲイン $K$ を求めよ（近似計算）。
(2) そのときの位相余裕 $PM$ を求めよ。

**解答**:
(1) $\omega=1$ におけるゲイン $|L(j1)|$ が 1 (0dB) になればよい。
    $$ |L(j1)| = \frac{K}{|j1| |j1+1| |j1+2|} = \frac{K}{1 \cdot \sqrt{1^2+1^2} \cdot \sqrt{1^2+2^2}} = \frac{K}{\sqrt{2}\sqrt{5}} = \frac{K}{\sqrt{10}} $$
    これが 1 なので、$K = \sqrt{10} \approx 3.16$。

(2) 位相 $\angle L(j1)$ を計算する。
    $$ \angle L(j1) = \angle \frac{1}{j} + \angle \frac{1}{j+1} + \angle \frac{1}{j+2} $$
    $$ = -90^\circ - \tan^{-1}(1) - \tan^{-1}(0.5) $$
    $$ = -90^\circ - 45^\circ - 26.6^\circ = -161.6^\circ $$
    位相余裕 $PM = 180^\circ + (-161.6^\circ) = \mathbf{18.4^\circ}$。

**考察**:
$PM \approx 18^\circ$ は小さすぎる（目標は $40^\circ \sim 60^\circ$）。
安定ですが振動的です。進み補償を入れて位相を戻すか、ゲインを下げて交差周波数を低くする必要があります。
