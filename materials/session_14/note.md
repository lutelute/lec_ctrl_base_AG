# 第14章：制御系の設計法 (詳細版)

本章では、代表的な制御器（コントローラ）であるPID制御の調整則と、より高度な設計手法である根軌跡法について解説します。
120分の講義を想定し、Ziegler-Nicholsの限界感度法の手順や、根軌跡の描画ルールを具体例を通して学びます。

---

## 14.1 PID制御 (Proportional-Integral-Derivative Control)

### 14.1.1 基本式と各項の役割
PID制御の伝達関数（パラレル型）は以下で表されます。
$$ C(s) = K_p + \frac{K_i}{s} + K_d s = K_p \left( 1 + \frac{1}{T_i s} + T_d s \right) $$

1.  **比例動作 (P)**:
    - 操作量: $u(t) = K_p e(t)$
    - 役割: 現在の偏差に反応して操作します。
    - 特徴: ゲイン $K_p$ を上げると速応性は増しますが、定常偏差は残り（オフセット）、上げすぎると振動的になります。

2.  **積分動作 (I)**:
    - 操作量: $u(t) = K_i \int e(t) dt$
    - 役割: 過去の偏差の蓄積に反応します。
    - 特徴: **定常偏差をゼロにします**（システムを1型以上に昇格させる）。ただし位相を90度遅らせるため、安定性を悪化させる要因になります。

3.  **微分動作 (D)**:
    - 操作量: $u(t) = K_d \frac{de(t)}{dt}$
    - 役割: 未来の偏差の変化（傾向）を予測して、ブレーキをかけます。
    - 特徴: 振動を抑制し（減衰を増やし）、速応性を高めます。位相を90度進めるため安定化に寄与しますが、高周波ノイズを増幅します。

---

## 14.2 PID調整法 (Tuning Methods)

制御対象のモデルが不明な場合でも、実験的にパラメータを決める手法です。

### 14.2.1 Ziegler-Nicholsの限界感度法
閉ループ系を実際に動かして調整する方法です。

**手順**:
1.  積分動作・微分動作を切る（$T_i=\infty, T_d=0$）。すなわちP制御のみにする。
2.  比例ゲイン $K_p$ を徐々に上げていく。
3.  出力が安定限界（持続振動）になったときのゲインを **限界感度 $K_u$**、その振動周期を **限界周期 $T_u$** として記録する。
4.  以下の表に従ってPIDパラメータを決定する。

| 制御則  | $K_p$      | $T_i$      | $T_d$       |
| :------ | :--------- | :--------- | :---------- |
| **P**   | $0.5 K_u$  | -          | -           |
| **PI**  | $0.45 K_u$ | $0.83 T_u$ | -           |
| **PID** | $0.6 K_u$  | $0.5 T_u$  | $0.125 T_u$ |

**解説**:
この調整則は「減衰係数 $\approx 0.25$」という、比較的振動的だが速い応答（四分の一減衰）を目指す設定になっています。オーバーシュートを抑えたい場合はゲインを少し下げる必要があります。

### 14.2.2 ステップ応答法
開ループのステップ応答波形（S字カーブ）から、無駄時間 $L$ と時定数 $T$ を読み取り、公式（CHR法など）に当てはめる方法です。

---

## 14.3 根軌跡法 (Root Locus Method)

ループゲイン $K$ を $0 \to \infty$ まで変化させたとき、閉ループ極（特性方程式の根）が複素平面上をどのように移動するかを描いた図です。
系の安定性や過渡特性を視覚的に設計できます。

### 14.3.1 根軌跡のルール
一巡伝達関数 $L(s) = K \frac{N(s)}{D(s)}$ とします。
特性方程式は $1 + L(s) = 0 \iff D(s) + K N(s) = 0$ です。

主な描画ルールは以下の通りです。

1.  **始点 ($K=0$)**: 開ループ極 ($D(s)=0$ の根) から出発する。
2.  **終点 ($K=\infty$)**: 開ループ零点 ($N(s)=0$ の根) に到着する。零点の数が極より少ない場合、残りは無限遠点へ向かう。
3.  **実軸上の軌跡**: 右側にある極・零点の総数が「奇数個」となる区間が根軌跡となる。
4.  **漸近線**: $n$ 個の極と $m$ 個の零点がある場合、$n-m$ 本の漸近線に沿って無限遠へ向かう。
    - 漸近線の交点: $\sigma_a = \frac{\sum p_i - \sum z_i}{n - m}$
    - 漸近線の角度: $\theta_a = \frac{180^\circ(2k+1)}{n - m}$

### 14.3.2 具体例
$$ L(s) = \frac{K}{s(s+2)} $$
- **極**: $p_1=0, p_2=-2$。
- **零点**: なし。
- **実軸上の軌跡**: 0と-2の間（右側の極数が1個）。
- **分岐点**: 2つの極から出た軌跡が実軸上で衝突し、上下（複素平面）へ分岐する。
  分離点は $s=-1$。
- **軌跡の形状**: $s=-1$ を通り虚軸に平行な直線となる。

**設計への応用**:
ゲイン $K$ を上げていくと、根は虚軸から離れず実部が $-1$ で一定ですが、虚部が大きくなる（振動周波数が上がる）ことがわかります。
もし要素を追加して根軌跡を左側に曲げられれば、整定時間を短縮できます。

---

## 14.4 演習問題：PID設計

**問題**:
2次遅れ系 $P(s) = \frac{1}{(s+1)(s+3)}$ に対し、PI制御 $C(s) = K_p (1 + \frac{1}{T_i s})$ を適用する。
$T_i = 1$ と選んだ場合、PI補償によって極が極と零点で相殺 (Pole-Zero Cancellation) されることを示し、その時の閉ループ伝達関数を求めよ。

**解答**:
PI制御器の式を変形します。
$$ C(s) = K_p \frac{T_i s + 1}{T_i s} $$
$T_i=1$ を代入すると、
$$ C(s) = K_p \frac{s + 1}{s} $$

一巡伝達関数は、
$$ L(s) = C(s)P(s) = K_p \frac{s+1}{s} \cdot \frac{1}{(s+1)(s+3)} $$
ここで、コントローラの零点 $(s+1)$ が、プラントの極 $(s+1)$ を打ち消します。
$$ L(s) = \frac{K_p}{s(s+3)} $$

閉ループ伝達関数 $W(s)$ は、
$$ W(s) = \frac{L(s)}{1+L(s)} = \frac{\frac{K_p}{s(s+3)}}{1 + \frac{K_p}{s(s+3)}} = \frac{K_p}{s(s+3) + K_p} = \frac{K_p}{s^2 + 3s + K_p} $$

**考察**:
極零相殺により、系は見かけ上 2次系（$s+1$ の影響がない）となります。
1型（積分器あり）なので定常偏差は0になり、かつ $K_p$ を調整することで $\omega_n = \sqrt{K_p}$ を自由に設定できます。
（ただし相殺された極 $s=-1$ が安定であるため問題ありませんが、不安定極を相殺することは許されません）
